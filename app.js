/*! For license information please see app.js.LICENSE.txt */
(()=>{"use strict";function t(){var e,n,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function a(t,o,c,i){var a=o&&o.prototype instanceof f?o:f,s=Object.create(a.prototype);return r(s,"_invoke",function(t,r,o){var c,i,a,f=0,s=o||[],l=!1,p={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,r){return c=t,i=0,a=e,p.n=r,u}};function v(t,r){for(i=t,a=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,c=s[n],v=p.p,d=c[2];t>3?(o=d===r)&&(a=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=e):c[0]<=v&&((o=t<2&&v<c[1])?(i=0,p.v=r,p.n=c[1]):v<d&&(o=t<3||c[0]>r||r>d)&&(c[4]=t,c[5]=r,p.n=d,i=0))}if(o||t>1)return u;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&v(s,d),i=s,a=d;(n=i<2?e:a)||!l;){c||(i?i<3?(i>1&&(p.n=-1),v(i,a)):p.n=a:p.v=a);try{if(f=2,c){if(i||(o="next"),n=c[o]){if(!(n=n.call(c,a)))throw TypeError("iterator result is not an object");if(!n.done)return n;a=n.value,i<2&&(i=0)}else 1===i&&(n=c.return)&&n.call(c),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=e}else if((n=(l=p.n<0)?a:t.call(r,p))!==u)break}catch(t){c=e,i=1,a=t}finally{f=1}}return{value:n,done:l}}}(t,c,i),!0),s}var u={};function f(){}function s(){}function l(){}n=Object.getPrototypeOf;var p=[][c]?n(n([][c]())):(r(n={},c,function(){return this}),n),v=l.prototype=f.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,r(t,i,"GeneratorFunction")),t.prototype=Object.create(v),t}return s.prototype=l,r(v,"constructor",l),r(l,"constructor",s),s.displayName="GeneratorFunction",r(l,i,"GeneratorFunction"),r(v),r(v,i,"Generator"),r(v,c,function(){return this}),r(v,"toString",function(){return"[object Generator]"}),(t=function(){return{w:a,m:d}})()}function r(t,e,n,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}r=function(t,e,n,o){function i(e,n){r(t,e,function(t){return this._invoke(e,n,t)})}e?c?c(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},r(t,e,n,o)}function e(t,r,e,n,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void e(t)}a.done?r(u):Promise.resolve(u).then(n,o)}function n(t){return function(){var r=this,n=arguments;return new Promise(function(o,c){var i=t.apply(r,n);function a(t){e(i,o,c,a,u,"next",t)}function u(t){e(i,o,c,a,u,"throw",t)}a(void 0)})}}var o=function(){var r=n(t().m(function r(e,n){var o,c,i;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a("/TiendaFalsa"+e);case 1:if(o=t.v){t.n=2;break}throw new Error("Peticion url: vacia");case 2:c=Handlebars.compile(o),document.getElementById("view").innerHTML=c(n),t.n=4;break;case 3:t.p=3,i=t.v,console.error("Error renderPage",i.message);case 4:return t.a(2)}},r,null,[[0,3]])}));return function(t,e){return r.apply(this,arguments)}}(),c=function(){var r=n(t().m(function r(e){var n=arguments;return t().w(function(t){for(;;)switch(t.n){case 0:if((!(n.length>1&&void 0!==n[1])||n[1])&&history.pushState({},"",e),!E[location.pathname]){t.n=1;break}return t.a(2,E[location.pathname]());case 1:return console.warn("Ruta no existe, volviendo a home"),t.a(2,E["/home"]());case 2:return t.a(2)}},r)}));return function(t){return r.apply(this,arguments)}}(),i=function(){var r=n(t().m(function r(e){var n,o;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a(e);case 1:if((n=t.v)&&(!Array.isArray(n)||0!==n.length)){t.n=2;break}throw new Error("Petición urlData: vacía");case 2:return t.a(2,JSON.parse(n));case 3:t.p=3,o=t.v,console.error("Error getApi",o.message);case 4:return t.a(2)}},r,null,[[0,3]])}));return function(t){return r.apply(this,arguments)}}();function a(t){return u.apply(this,arguments)}function u(){return(u=n(t().m(function r(e){var n,o,c,i;return t().w(function(t){for(;;)switch(t.n){case 0:if(n="CACHED_".concat(e),!(o=localStorage.getItem(n))){t.n=1;break}return t.a(2,o);case 1:return t.n=2,fetch(e);case 2:if((c=t.v).ok){t.n=3;break}throw new Error("Error local_storage HTTP: ".concat(c.status));case 3:return t.n=4,c.text();case 4:return i=t.v,localStorage.setItem(n,i),t.a(2,i)}},r)}))).apply(this,arguments)}var f={items:[],catalogo:[],findItem:function(t){return this.items.find(function(r){return r.id===t})},add:function(t){this.findItem(t)?this.increase(t):(this.items.push({id:t,count:1}),console.log("Articulo id: ".concat(t," add carrito")))},remove:function(t){this.items=this.items.filter(function(r){return r.id!==t}),console.log("Articulo id: ".concat(t," remove"))},increase:function(t){this.findItem(t).count++},substract:function(t){var r=this.findItem(t);r.count>0&&r.count--,0===r.count&&this.remove(t)},json:function(){var t=this;return this.items.flatMap(function(r){return t.catalogo.filter(function(t){return t.id===r.id}).map(function(t){return{id:t.id,nombre:t.nombre,precio:t.precio,count:r.count,total:t.precio*r.count}})})},total:function(){return this.json().reduce(function(t,r){return t+r.total},0)}};function s(){var t,r,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,n,o,c){var u=n&&n.prototype instanceof a?n:a,f=Object.create(u.prototype);return l(f,"_invoke",function(e,n,o){var c,a,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(r,e){return c=r,a=0,u=t,p.n=e,i}};function v(e,n){for(a=e,u=n,r=0;!l&&f&&!o&&r<s.length;r++){var o,c=s[r],v=p.p,d=c[2];e>3?(o=d===n)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=t):c[0]<=v&&((o=e<2&&v<c[1])?(a=0,p.v=n,p.n=c[1]):v<d&&(o=e<3||c[0]>n||n>d)&&(c[4]=e,c[5]=n,p.n=d,a=0))}if(o||e>1)return i;throw l=!0,n}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&v(s,d),a=s,u=d;(r=a<2?t:u)||!l;){c||(a?a<3?(a>1&&(p.n=-1),v(a,u)):p.n=u:p.v=u);try{if(f=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=t}else if((r=(l=p.n<0)?u:e.call(n,p))!==i)break}catch(r){c=t,a=1,u=r}finally{f=1}}return{value:r,done:l}}}(e,o,c),!0),f}var i={};function a(){}function u(){}function f(){}r=Object.getPrototypeOf;var p=[][n]?r(r([][n]())):(l(r={},n,function(){return this}),r),v=f.prototype=a.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(v),t}return u.prototype=f,l(v,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(v),l(v,o,"Generator"),l(v,n,function(){return this}),l(v,"toString",function(){return"[object Generator]"}),(s=function(){return{w:c,m:d}})()}function l(t,r,e,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,r,e,n){function c(r,e){l(t,r,function(t){return this._invoke(r,e,t)})}r?o?o(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n}):t[r]=e:(c("next",0),c("throw",1),c("return",2))},l(t,r,e,n)}function p(t,r,e,n,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void e(t)}a.done?r(u):Promise.resolve(u).then(n,o)}var v=function(){var t,r=(t=s().m(function t(){var r;return s().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o("/resources/template/carritoPage.hbs",{carrito:f.json(),total:f.total()});case 1:document.getElementById("home").addEventListener("click",function(){c("/home")}),document.querySelectorAll(".btn-disminuye").forEach(function(t){return t.addEventListener("click",function(t){var r=t.target.classList[0].replace("id-","");f.substract(r),c("/carrito")})}),document.querySelectorAll(".btn-aumenta").forEach(function(t){return t.addEventListener("click",function(t){var r=t.target.classList[0].replace("id-","");f.increase(r),c("/carrito")})}),document.querySelectorAll(".btn-remove").forEach(function(t){return t.addEventListener("click",function(t){var r=t.target.classList[0].replace("id-","");f.remove(r),c("/carrito")})}),document.getElementById("btn-volver").addEventListener("click",function(){c("/home")}),document.getElementById("btn-procesar").addEventListener("click",function(){alert("Procesando compra...")}),t.n=3;break;case 2:t.p=2,r=t.v,console.error("Error peticion: CarritoPage",r.message),document.getElementById("view").innerHTML="<p>Error al cargar Articulo</p>";case 3:return t.a(2)}},t,null,[[0,2]])}),function(){var r=this,e=arguments;return new Promise(function(n,o){var c=t.apply(r,e);function i(t){p(c,n,o,i,a,"next",t)}function a(t){p(c,n,o,i,a,"throw",t)}i(void 0)})});return function(){return r.apply(this,arguments)}}();function d(){var t,r,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,n,o,c){var u=n&&n.prototype instanceof a?n:a,f=Object.create(u.prototype);return h(f,"_invoke",function(e,n,o){var c,a,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(r,e){return c=r,a=0,u=t,p.n=e,i}};function v(e,n){for(a=e,u=n,r=0;!l&&f&&!o&&r<s.length;r++){var o,c=s[r],v=p.p,d=c[2];e>3?(o=d===n)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=t):c[0]<=v&&((o=e<2&&v<c[1])?(a=0,p.v=n,p.n=c[1]):v<d&&(o=e<3||c[0]>n||n>d)&&(c[4]=e,c[5]=n,p.n=d,a=0))}if(o||e>1)return i;throw l=!0,n}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&v(s,d),a=s,u=d;(r=a<2?t:u)||!l;){c||(a?a<3?(a>1&&(p.n=-1),v(a,u)):p.n=u:p.v=u);try{if(f=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=t}else if((r=(l=p.n<0)?u:e.call(n,p))!==i)break}catch(r){c=t,a=1,u=r}finally{f=1}}return{value:r,done:l}}}(e,o,c),!0),f}var i={};function a(){}function u(){}function f(){}r=Object.getPrototypeOf;var s=[][n]?r(r([][n]())):(h(r={},n,function(){return this}),r),l=f.prototype=a.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,h(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=f,h(l,"constructor",f),h(f,"constructor",u),u.displayName="GeneratorFunction",h(f,o,"GeneratorFunction"),h(l),h(l,o,"Generator"),h(l,n,function(){return this}),h(l,"toString",function(){return"[object Generator]"}),(d=function(){return{w:c,m:p}})()}function h(t,r,e,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}h=function(t,r,e,n){function c(r,e){h(t,r,function(t){return this._invoke(r,e,t)})}r?o?o(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n}):t[r]=e:(c("next",0),c("throw",1),c("return",2))},h(t,r,e,n)}function y(t,r,e,n,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void e(t)}a.done?r(u):Promise.resolve(u).then(n,o)}var m=function(){var t,r=(t=d().m(function t(){var r,e,n,i;return d().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,localStorage.setItem("lastSearch",location.search),history.replaceState({},"","/home".concat(location.search)),r=f.catalogo,!(e=new URLSearchParams(location.search)).get("s")){t.n=4;break}n=e.get("s"),t.n="menorPrecio"===n?1:"mayorPrecio"===n?2:3;break;case 1:return r=r.sort(function(t,r){return parseFloat(t.precio)-parseFloat(r.precio)}),t.a(3,3);case 2:return r=r.sort(function(t,r){return parseFloat(r.precio)-parseFloat(t.precio)}),t.a(3,3);case 3:case 4:return e.get("q")&&(r=r.filter(function(t){return t.nombre.toLowerCase().includes("".concat(e.get("q")))})),t.n=5,o("/resources/template/indexPage.hbs",{articulos:r});case 5:document.getElementById("search-form").addEventListener("submit",function(t){t.preventDefault(),c("/home?q=".concat(t.target[0].value.trim().toLowerCase(),"&s=").concat(t.target[1].value))}),document.querySelectorAll(".article-list .article").forEach(function(t){return t.addEventListener("click",function(t){c("/articulo?id=".concat(t.currentTarget.getAttribute("data-id")))})}),document.querySelector(".btn-carrito").addEventListener("click",function(t){t.preventDefault(),c("/carrito")}),t.n=7;break;case 6:t.p=6,i=t.v,console.error("Error peticion render",i.message),document.getElementById("view").innerHTML="<p>Error al cargar la página</p>";case 7:return t.a(2)}},t,null,[[0,6]])}),function(){var r=this,e=arguments;return new Promise(function(n,o){var c=t.apply(r,e);function i(t){y(c,n,o,i,a,"next",t)}function a(t){y(c,n,o,i,a,"throw",t)}i(void 0)})});return function(){return r.apply(this,arguments)}}();function b(){var t,r,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,n,o,c){var u=n&&n.prototype instanceof a?n:a,f=Object.create(u.prototype);return g(f,"_invoke",function(e,n,o){var c,a,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(r,e){return c=r,a=0,u=t,p.n=e,i}};function v(e,n){for(a=e,u=n,r=0;!l&&f&&!o&&r<s.length;r++){var o,c=s[r],v=p.p,d=c[2];e>3?(o=d===n)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=t):c[0]<=v&&((o=e<2&&v<c[1])?(a=0,p.v=n,p.n=c[1]):v<d&&(o=e<3||c[0]>n||n>d)&&(c[4]=e,c[5]=n,p.n=d,a=0))}if(o||e>1)return i;throw l=!0,n}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&v(s,d),a=s,u=d;(r=a<2?t:u)||!l;){c||(a?a<3?(a>1&&(p.n=-1),v(a,u)):p.n=u:p.v=u);try{if(f=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=t}else if((r=(l=p.n<0)?u:e.call(n,p))!==i)break}catch(r){c=t,a=1,u=r}finally{f=1}}return{value:r,done:l}}}(e,o,c),!0),f}var i={};function a(){}function u(){}function f(){}r=Object.getPrototypeOf;var s=[][n]?r(r([][n]())):(g(r={},n,function(){return this}),r),l=f.prototype=a.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,g(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=f,g(l,"constructor",f),g(f,"constructor",u),u.displayName="GeneratorFunction",g(f,o,"GeneratorFunction"),g(l),g(l,o,"Generator"),g(l,n,function(){return this}),g(l,"toString",function(){return"[object Generator]"}),(b=function(){return{w:c,m:p}})()}function g(t,r,e,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}g=function(t,r,e,n){function c(r,e){g(t,r,function(t){return this._invoke(r,e,t)})}r?o?o(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n}):t[r]=e:(c("next",0),c("throw",1),c("return",2))},g(t,r,e,n)}function w(t,r,e,n,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void e(t)}a.done?r(u):Promise.resolve(u).then(n,o)}var E={"/home":m,"/articulo":function(){var t,r=(t=b().m(function t(){var r,e,n,a;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,r="/resources/template/articuloPage.hbs",e=new URLSearchParams(location.search),t.n=1,i("https://67d36cda8bca322cc26a1278.mockapi.io/tiendaApi/articulos/"+e.get("id"));case 1:return n=t.v,t.n=2,o(r,n);case 2:document.getElementById("home").addEventListener("click",function(){c("/home")}),document.querySelector(".btn-volver").addEventListener("click",function(){c("/home")}),document.querySelector(".btn-add").addEventListener("click",function(t){t.preventDefault(),f.add(e.get("id")),c("/carrito")}),t.n=4;break;case 3:t.p=3,a=t.v,console.error("Error peticion: ArticuloPage",a.message),document.getElementById("view").innerHTML="<p>Error al cargar Articulo</p>";case 4:return t.a(2)}},t,null,[[0,3]])}),function(){var r=this,e=arguments;return new Promise(function(n,o){var c=t.apply(r,e);function i(t){w(c,n,o,i,a,"next",t)}function a(t){w(c,n,o,i,a,"throw",t)}i(void 0)})});return function(){return r.apply(this,arguments)}}(),"/carrito":v};function O(){var t,r,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,n,o,c){var u=n&&n.prototype instanceof a?n:a,f=Object.create(u.prototype);return j(f,"_invoke",function(e,n,o){var c,a,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(r,e){return c=r,a=0,u=t,p.n=e,i}};function v(e,n){for(a=e,u=n,r=0;!l&&f&&!o&&r<s.length;r++){var o,c=s[r],v=p.p,d=c[2];e>3?(o=d===n)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=t):c[0]<=v&&((o=e<2&&v<c[1])?(a=0,p.v=n,p.n=c[1]):v<d&&(o=e<3||c[0]>n||n>d)&&(c[4]=e,c[5]=n,p.n=d,a=0))}if(o||e>1)return i;throw l=!0,n}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&v(s,d),a=s,u=d;(r=a<2?t:u)||!l;){c||(a?a<3?(a>1&&(p.n=-1),v(a,u)):p.n=u:p.v=u);try{if(f=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=t}else if((r=(l=p.n<0)?u:e.call(n,p))!==i)break}catch(r){c=t,a=1,u=r}finally{f=1}}return{value:r,done:l}}}(e,o,c),!0),f}var i={};function a(){}function u(){}function f(){}r=Object.getPrototypeOf;var s=[][n]?r(r([][n]())):(j(r={},n,function(){return this}),r),l=f.prototype=a.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,j(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=f,j(l,"constructor",f),j(f,"constructor",u),u.displayName="GeneratorFunction",j(f,o,"GeneratorFunction"),j(l),j(l,o,"Generator"),j(l,n,function(){return this}),j(l,"toString",function(){return"[object Generator]"}),(O=function(){return{w:c,m:p}})()}function j(t,r,e,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}j=function(t,r,e,n){function c(r,e){j(t,r,function(t){return this._invoke(r,e,t)})}r?o?o(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n}):t[r]=e:(c("next",0),c("throw",1),c("return",2))},j(t,r,e,n)}function P(t,r,e,n,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void e(t)}a.done?r(u):Promise.resolve(u).then(n,o)}function S(t){return function(){var r=this,e=arguments;return new Promise(function(n,o){var c=t.apply(r,e);function i(t){P(c,n,o,i,a,"next",t)}function a(t){P(c,n,o,i,a,"throw",t)}i(void 0)})}}window.addEventListener("DOMContentLoaded",S(O().m(function t(){return O().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,i("https://67d36cda8bca322cc26a1278.mockapi.io/tiendaApi/articulos");case 1:f.catalogo=t.v,m();case 2:return t.a(2)}},t)}))),window.addEventListener("popstate",function(t){var r=localStorage.getItem("lastSearch")||"";"/home"===location.pathname?c("/home".concat(r),!1):c(location.href,!1)})})();